groups:
  - name: auditai-alerts
    rules:
      - alert: AuditAIHigh5xxRate
        expr: |
          (
            sum(rate(auditai_http_errors_total{path!="/health"}[5m]))
            /
            clamp_min(sum(rate(auditai_http_requests_total{path!="/health"}[5m])), 1)
          ) > 0.05
        for: 10m
        labels:
          severity: warning
          service: auditai-backend
        annotations:
          summary: "AuditAI elevated error rate"
          description: "HTTP error ratio has exceeded 5% for 10 minutes."

      - alert: AuditAILLMFailureBurst
        expr: sum(rate(auditai_llm_failures_total[10m])) > 0.1
        for: 15m
        labels:
          severity: critical
          service: auditai-backend
        annotations:
          summary: "AuditAI LLM failures are rising"
          description: "LLM failure rate is above baseline for 15 minutes."
